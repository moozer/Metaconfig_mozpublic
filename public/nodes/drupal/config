##
## Configuration for public/nodes/drupal
##
import "public/profile/standard"
import "public/config/screenrc"
import "public/config/rclocal"
import "public/config/toprc"
import "public/config/vimrc"
import "public/config/hostname"
import "public/service/ssh"
import "public/config/ssh-key-root"
import "public/service/postfix"
import "public/service/apache2"
import "som/shim"

[settings.public/config/sudo]
sudoers += "tdn|ALL|ALL|NOPASSWD:|ALL"
sudoers += "%admin|ALL|ALL||ALL"
sudoers += "%sudo|ALL|ALL||ALL"
[settings.public/config/hostname]
hostname = "drupal"

[settings.public/config/ssh-key-root]
authorized_keys += "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6FqDQUZmSs4VC6EhMzLtZIjrSH5cIDKcKN/zJmtd7iIx8MluqqaGi/opq2sD+H0nNWtuWUhfmBhgEA7BYzZvAsJFQ3ArdegGu1HMj2sI13t8x9fCYrstbK9VxcC5d9TDgn7bTtkTtdB6Svhjk1Agpl6sGtyTV3IIDklaNOTKR75NSZOzdAtdwSTAQluws7Ohkpb1fqJ1LtThPCpQMTX3MLjRY48n3sIHthquUOaeXBpVMsgXxAIUxQsTJ3RkE5rf+JkXJrbrW1cTrs3DrpwFgGD6tJuInO4+t04USoMJJG9ydxcT6fKm9XVDNcfmtnd3gWEKKLhqcnm90h+GveYZzQ== tdn"

[settings.public/service/postfix]
myhostname = "drupal.vineyard.sikkerhed.org"
root_destination = "tdn@sikkerhed.org"

[settings.public/service/apache2]
vhost_dir = "/data/www/virtual"
sites_enable += "drupal.example.org"
namevirtualhost += ["*:80"]



[files]
block += "/root/.ssh/authorized_keys"
block += "/etc/hosts.allow"
block += "/etc/ssh/sshd_config"
######### Drupal 

[apt]
install += "drupal7"
install += "postgresql"
install += "php5-pgsql"
install += "php-pear"
install += "php5-suhosin"

[files]
symlink["/etc/apache2/metaconfig.d/drupal7.conf"] = "/etc/drupal/7/apache2.conf"
mkdir += "/data"
mkdir += "/data/www"
mkdir += "/data/www/log"
