##
## Configuration for public/service/iscsi-server
##

[apt]
install += "iscsitarget"

[files]
permission["/etc/ietd.conf"] = "0600"

[trigger.restart-iscsitarget]
files += "/etc/ietd.conf"
command = ["invoke-rc.d", "iscsitarget", "restart"]

[files]
mkdir += "/etc/default/iscsi"

if PLATFORM_OS_NAME == "debian" and PLATFORM_OS_VERSION >= "6"
  mkdir += "/etc/iet"
  remap["/etc/ietd.conf"] = "/etc/iet/ietd.conf"
  remap["/etc/initiators.allow"] = "/etc/iet/initiators.allow"
  block += "/etc/initiators.deny"
end

[settings]
discovery_users = dict()
targets = dict()
