##
## Configuration for public/service/ssh
##

if PLATFORM_OS_YUM_BASED
  [yum]
  install += "openssh-server"

  [trigger.restart-sshd]
  files += "/etc/ssh/sshd_config"
  command = ["service", "sshd", "restart"]
elif PLATFORM_OS_APT_BASED
  [apt]
  install += "openssh-server"

  [trigger.restart-sshd]
  files += "/etc/ssh/sshd_config"
  command = ["invoke-rc.d", "ssh", "restart"]
else
  unsupported()
end

[settings]
permit_root_login       = "without-password"
ports                   = [22]
allow_sftp              = 1
allow_gateway_ports     = 1
allow_x11_forwarding    = 1
disable_ipv6            = 0
maxstartups             = "10:30:60"
use_pam                 = "yes"
use_privilege_separation= "yes"
strict_modes            = "yes"
login_grace_time        = "120"
tcp_keepalive           = "yes"
password_authentication = "no"
listen                  = []
ssh_hosts               = dict()
address_family          = "any"
sshd_match              = dict()

[files]
permission["/etc/ssh/ssh_host_[dr]sa_key"] = "0600"
permission["/root/.ssh/authorized_keys"] = "0600"
owner["/etc/ssh/*"] = "root:root"
