##
## Configuration for public/service/apache2
##

[settings]
listen = ["80", "443"]
nfs = 0
namevirtualhost = []

serverroot              = "/etc/apache2"
servername              = None
timeout                 = "45"
keepalive               = "On"
maxkeepaliverequests    = "100"
keepalivetimeout        = "15"
accessfilename          = ".htaccess"
defaulttype             = "text/plain"
hostnamelookups         = "Off"
loglevel                = "warn"
servertokens            = "prod"
serversignature         = "Off"
default_charset         = "UTF-8"


lock_dir = "${APACHE_LOCK_DIR}"
pid_file = "${APACHE_PID_FILE}"
user     = "${APACHE_RUN_USER}"
group    = "${APACHE_RUN_GROUP}"
log_dir   = "/var/log/apache2"
vhost_dir = "/var/www/virtual"

prefork_startservers         =   5
prefork_minspareservers      =   5
prefork_maxspareservers      =  10
prefork_maxclients           = 150
prefork_maxrequestsperchild  = 300
prefork_keepalivetimeout     =   2

worker_startservers          =   2
worker_minsparethreads       =  25
worker_maxsparethreads       =  75
worker_threadsperchild       =  25
worker_maxclients            = 150
worker_maxrequestsperchild   = 300
worker_threadlimit           =  64

event_startservers           =   2
event_maxclients             = 150
event_minsparethreads        =  25
event_maxsparethreads        =  75
event_threadlimit            =  64
event_threadsperchild        =  25
event_maxrequestsperchild    = 300

## mod_headers is enabled due to the security fix in /etc/metaconfig/res/service/apache2/metaconfig.d/range-limit.conf
mods_enable = ["ssl", "rewrite", "headers"]
mods_disable = ["autoindex", "status"]
sites_enable = []
sites_disable = []

[trigger.reload-apache2]
files += "/etc/apache2/sites-available/*"
command = ["invoke-rc.d", "apache2", "reload"]

[trigger.restart-apache2]
files += "/etc/apache2/mods-enabled/*"
files += "/etc/apache2/metaconfig.d/*"
files += "/etc/apache2/*.conf"
command = ["invoke-rc.d", "apache2", "restart"]

