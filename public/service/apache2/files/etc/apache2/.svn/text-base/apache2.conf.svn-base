#### Section 1: Global Environment
##
## The directives in this section affect the overall operation of Apache,
## such as the number of concurrent requests it can handle or where it
## can find its configuration files.
##
%header("##")
## ServerRoot: The top of the directory tree under which the server's
## configuration, error, and log files are kept.
## Do NOT add a slash at the end of the directory path.
ServerRoot "/etc/apache2"
#if servername
  ServerName "%(servername)"
#end

## The accept serialization lock file MUST BE STORED ON A LOCAL DISK.
LockFile %(lock_dir)/accept.lock

## PidFile: The file in which the server should record its process
## identification number when it starts.
## This needs to be set in /etc/apache2/envvars
PidFile %(pid_file)

## Timeout: The number of seconds before receives and sends time out.
Timeout %(timeout)
## KeepAlive: Whether or not to allow persistent connections (more than
## one request per connection). Set to "Off" to deactivate.
KeepAlive %(keepalive)
## MaxKeepAliveRequests: The maximum number of requests to allow
## during a persistent connection. Set to 0 to allow an unlimited amount.
## We recommend you leave this number high, for maximum performance.
MaxKeepAliveRequests %(maxkeepaliverequests)
## KeepAliveTimeout: Number of seconds to wait for the next request from the
## same client on the same connection.
KeepAliveTimeout %(keepalivetimeout)

## prefork MPM
## StartServers: number of server processes to start
## MinSpareServers: minimum number of server processes which are kept spare
## MaxSpareServers: maximum number of server processes which are kept spare
## MaxClients: maximum number of server processes allowed to start
## MaxRequestsPerChild: maximum number of requests a server process serves
<IfModule mpm_prefork_module>
    StartServers        %(prefork_startservers)
    MinSpareServers     %(prefork_minspareservers)
    MaxSpareServers     %(prefork_maxspareservers)
    MaxClients          %(prefork_maxclients)
    MaxRequestsPerChild %(prefork_maxrequestsperchild)
</IfModule>

## worker MPM
## StartServers: initial number of server processes to start
## MaxClients: maximum number of simultaneous client connections
## MinSpareThreads: minimum number of worker threads which are kept spare
## MaxSpareThreads: maximum number of worker threads which are kept spare
## ThreadLimit: ThreadsPerChild can be changed to this maximum value during a
##              graceful restart. ThreadLimit can only be changed by stopping
##              and starting Apache.
## ThreadsPerChild: constant number of worker threads in each server process
## MaxRequestsPerChild: maximum number of requests a server process serves
<IfModule mpm_worker_module>
    StartServers        %(worker_startservers)
    MinSpareThreads     %(worker_minsparethreads)
    MaxSpareThreads     %(worker_maxsparethreads)
    ThreadsPerChild     %(worker_threadsperchild)
    MaxClients          %(worker_maxclients)
    MaxRequestsPerChild %(worker_maxrequestsperchild)
    ThreadLimit         %(worker_threadlimit)
</IfModule>

## event MPM
## StartServers: initial number of server processes to start
## MaxClients: maximum number of simultaneous client connections
## MinSpareThreads: minimum number of worker threads which are kept spare
## MaxSpareThreads: maximum number of worker threads which are kept spare
## ThreadsPerChild: constant number of worker threads in each server process
## MaxRequestsPerChild: maximum number of requests a server process serves
<IfModule mpm_event_module>
    StartServers        %(event_startservers)
    MaxClients          %(event_maxclients)
    MinSpareThreads     %(event_minsparethreads)
    MaxSpareThreads     %(event_maxsparethreads)
    ThreadLimit         %(event_threadlimit)
    ThreadsPerChild     %(event_threadsperchild)
    MaxRequestsPerChild %(event_maxrequestsperchild)
</IfModule>

## These need to be set in /etc/apache2/envvars
User %(user)
Group %(group)

## AccessFileName: The name of the file to look for in each directory
## for additional configuration directives.  See also the AllowOverride
## directive.
AccessFileName %(accessfilename)

## The following lines prevent .* files from being viewed by Web clients. 
<Files ~ "^\.">
    Order allow,deny
    Deny from all
    Satisfy all
</Files>

<Directory ~ "^/.*/\.">
    Order allow,deny
    Deny from all
    Satisfy all
</Directory>

## DefaultType is the default MIME type the server will use for a document
## if it cannot otherwise determine one, such as from filename extensions.
## If your server contains mostly text or HTML documents, "text/plain" is
## a good value.  If most of your content is binary, such as applications
## or images, you may want to use "application/octet-stream" instead to
## keep browsers from trying to display binary files as though they are
## text.
DefaultType %(defaulttype)

## HostnameLookups: Log the names of clients or just their IP addresses
## e.g., www.apache.org (on) or 204.62.129.132 (off).
## The default is off because it'd be overall better for the net if people
## had to knowingly turn this feature on, since enabling it means that
## each client request will result in AT LEAST one lookup request to the
## nameserver.
HostnameLookups %(hostnamelookups)

## ErrorLog: The location of the error log file.
## If you do not specify an ErrorLog directive within a <VirtualHost>
## container, error messages relating to that virtual host will be
## logged here.  If you *do* define an error logfile for a <VirtualHost>
## container, that host's errors will be logged there and not here.
ErrorLog "|/usr/bin/cronolog %(log_dir)/%%Y-%%m-%%d-apache2-error.log"
ErrorLog "%(log_dir)/current-apache2-error.log"
## BEGIN squeeze
##ErrorLog ${APACHE_LOG_DIR}/error.log
## END squeeze
## LogLevel: Control the number of messages logged to the error_log.
## Possible values include: debug, info, notice, warn, error, crit,
## alert, emerg.
LogLevel %(loglevel)

## Include module configuration:
Include /etc/apache2/mods-enabled/*.load
Include /etc/apache2/mods-enabled/*.conf

## Include all the user configurations:
Include /etc/apache2/httpd.conf
## Include ports listing
Include /etc/apache2/ports.conf

## The following directives define some format nicknames for use with
## a CustomLog directive (see below).
## If you are behind a reverse proxy, you might want to change %h into %{X-Forwarded-For}i
LogFormat "%%v:%%p %%h %%l %%u %%t \"%%r\" %%>s %%O \"%%{Referer}i\" \"%%{User-Agent}i\"" vhost_combined
LogFormat "%%h %%l %%u %%t \"%%r\" %%>s %%O \"%%{Referer}i\" \"%%{User-Agent}i\"" combined
LogFormat "%%h %%l %%u %%t \"%%r\" %%>s %%O" common
LogFormat "%%{Referer}i -> %%U" referer
LogFormat "%%{User-agent}i" agent

## ServerTokens
## This directive configures what you return as the Server HTTP response
## Header. The default is 'Full' which sends information about the OS-Type
## and compiled in modules.
## Set to one of:  Full | OS | Minor | Minimal | Major | Prod
## where Full conveys the most information, and Prod the least.
ServerTokens %(servertokens)
##
## Optionally add a line containing the server version and virtual host
## name to server-generated pages (internal error documents, FTP directory 
## listings, mod_status and mod_info output etc., but not CGI generated 
## documents or custom error documents).
## Set to "EMail" to also include a mailto: link to the ServerAdmin.
## Set to one of:  On | Off | EMail
ServerSignature %(serversignature)
##
## Allow TRACE method
##
## Set to "extended" to also reflect the request body (only for testing and
## diagnostic purposes).
##
## Set to one of:  On | Off | extended
##
TraceEnable Off
##
<IfModule mod_mime.c>
    ## Specify a default charset for all pages sent out. This is
    ## always a good idea and opens the door for future internationalisation
    ## of your web site, should you ever want it. Specifying it as
    ## a default does little harm; as the standard dictates that a page
    ## is in iso-8859-1 (latin1) unless specified otherwise i.e. you
    ## are merely stating the obvious. There are also some security
    ## reasons in browsers, related to javascript and URL parsing
    ## which encourage you to always set a default char set.
    ##
    AddDefaultCharset %(default_charset)
</IfModule>

## Customizable error responses come in three flavors:
## 1) plain text 2) local redirects 3) external redirects
##
## Some examples:
##ErrorDocument 500 "The server made a boo boo."
##ErrorDocument 404 /missing.html
##ErrorDocument 404 "/cgi-bin/missing_handler.pl"
##ErrorDocument 402 http://www.example.com/subscription_info.html

#foreach host in namevirtualhost
  NameVirtualHost %(host)
#end

#if nfs
  EnableSendfile Off
  EnableMMAP Off
#end

## Include custom configuration
Include metaconfig.d/*.conf

## Include the virtual host configurations:
Include sites-enabled/
